import{j as s,N as u,I as x,r as b}from"./index-Cg2Mqwf9.js";import{a as h}from"./album-DAMXIxCZ.js";import{g as p}from"./gallery-hc2n_KjD.js";import{p as c,u as g}from"./catalog-Ks1EoZw8.js";function f({title:t,preview:r,nbPhotos:o,published:i,onTogglePublished:n}){const e=Array.isArray(r)&&r.length>0;return s.jsxs(u,{to:`/album?title=${t}`,className:"flex flex-row rounded-2xl overflow-clip bg-gray-400 hover:outline-3 outline-primary",children:[s.jsx("div",{className:"relative bg-gray-350 aspect-square h-24",children:e?s.jsx("img",{src:r[0].path,alt:"",className:"size-full object-cover",loading:"lazy"}):s.jsx("div",{className:"flex size-full items-center justify-center text-gray-400 text-sm",children:s.jsx(x,{name:"images",size:30,className:" fill-gray-100"})})}),s.jsxs("div",{className:"p-3 w-full flex justify-center felx flex-col",children:[s.jsx("h3",{className:"text-md font-medium text-white truncate",children:t}),s.jsx("span",{className:"text-md font-medium text-gray-100",children:o}),i!==void 0&&s.jsxs("div",{className:" flex items-center gap-2",children:[s.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${i?"bg-green-600 text-white":"bg-yellow-600 text-white"}`,children:i?"Publié":"Brouillon"}),n&&s.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded bg-gray-600 text-white hover:bg-gray-500",onClick:l=>{l.preventDefault(),n()},children:i?"Dépublier":"Publier"})]})]})]})}const y=h,d=p;function w(){const[t,r]=b.useState(y),o=e=>c(t,d,{albumId:e},{sort:"date-desc",limit:1}),i=e=>c(t,d,{albumId:e}).length,n=async e=>{try{const l=!e.published;r(m=>m.map(a=>a.albumId===e.albumId?{...a,published:l}:a)),await g(e.albumId,{published:l})}catch(l){r(m=>m.map(a=>a.albumId===e.albumId?{...a,published:e.published}:a)),console.error(l)}};return s.jsxs("div",{className:"album-list",children:[s.jsxs("div",{className:"head py-2 px-3 border-b-2",children:[s.jsx("h1",{className:"text-3xl text-white font-semibold",children:"Albums"}),s.jsx("span",{className:"nb-album text-md text-gray-100",children:t.length+" album"+(t.length>1?"s":"")})]}),s.jsx("div",{className:"grid gap-4 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 px-18 py-6",children:t.map(e=>s.jsx(f,{title:e.name,nbPhotos:i(e.albumId),preview:o(e.albumId),published:e.published,onTogglePublished:()=>n(e)},e.albumId))})]})}export{w as default};
