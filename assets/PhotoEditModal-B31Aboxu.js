import{r as t,j as s}from"./index-DSWP_m3q.js";import{g as I,b as N,e as S,f as E}from"./catalog-BaTOuE_l.js";function k({photo:a,onClose:n,onUpdated:c}){const[x,f]=t.useState([]),[h,j]=t.useState([]),[u,o]=t.useState(a?.albumId??""),[g,m]=t.useState(a?.tagId??""),[d,r]=t.useState(!1),[b,i]=t.useState("");if(t.useEffect(()=>{o(a?.albumId??""),m(a?.tagId??"")},[a?.tagId,a?.albumId]),t.useEffect(()=>{const e=new AbortController;return Promise.all([I(e.signal),N(e.signal)]).then(([l,p])=>{f(l),j(p)}).catch(l=>i(l instanceof Error?l.message:String(l))),()=>e.abort()},[]),!a)return null;const y=async()=>{if(a)try{r(!0);const e=await S(a.id,{albumId:u,tagId:g});c?.(e.entry),n()}catch(e){i(e instanceof Error?e.message:String(e))}finally{r(!1)}},v=async()=>{if(a)try{r(!0),await E(a.id),c?.(null,!0),n()}catch(e){i(e instanceof Error?e.message:String(e))}finally{r(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-gray-700 text-white rounded-lg shadow-xl w-full max-w-md p-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Modifier la photo"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1",children:"Album"}),s.jsxs("select",{className:"w-full bg-gray-600 rounded px-2 py-2",value:u,onChange:e=>o(e.target.value),children:[s.jsx("option",{value:"",children:"— Aucun —"}),x.map(e=>s.jsx("option",{value:e.albumId,children:e.name},e.albumId))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1",children:"Tag"}),s.jsxs("select",{className:"w-full bg-gray-600 rounded px-2 py-2",value:g,onChange:e=>m(e.target.value),children:[s.jsx("option",{value:"",children:"— Aucun —"}),h.map(e=>s.jsx("option",{value:e.tagId,children:e.name},e.tagId))]})]}),b&&s.jsx("div",{className:"text-sm text-red-300",children:b})]}),s.jsxs("div",{className:"mt-4 flex gap-2 justify-end",children:[s.jsx("button",{className:"px-3 py-2 rounded bg-gray-500 hover:bg-gray-400",onClick:n,disabled:d,children:"Annuler"}),s.jsx("button",{className:"px-3 py-2 rounded bg-red-600 hover:bg-red-500",onClick:v,disabled:d,children:"Supprimer"}),s.jsx("button",{className:"px-3 py-2 rounded bg-green-600 hover:bg-green-500",onClick:y,disabled:d,children:"Enregistrer"})]})]})})}export{k as P};
